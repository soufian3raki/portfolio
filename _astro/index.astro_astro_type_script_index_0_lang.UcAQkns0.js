function g(c){console.log("Opening certificate modal for:",c);const e=JSON.parse(c.dataset.certificate),s=document.getElementById("certificateModal"),l=(document.documentElement.getAttribute("data-locale")||"es")==="es";document.getElementById("modalTitle").textContent=l&&e.title_es||e.title,document.getElementById("modalImage").src=e.image,document.getElementById("modalImage").alt=l&&e.title_es||e.title,document.getElementById("modalIssuer").textContent=l&&e.issuer_es||e.issuer,document.getElementById("modalDate").textContent=new Date(e.date).toLocaleDateString(l?"es-ES":"en-US",{year:"numeric",month:"long",day:"numeric"}),document.getElementById("modalCategory").textContent=l&&e.category_es||e.category,document.getElementById("modalType").textContent=l?e.type_es||(e.type==="degree"?"Título":"Certificación"):e.type==="degree"?"Degree":"Certification",document.getElementById("modalDescription").textContent=l&&e.description_es||e.description,e.duration?(document.getElementById("modalDuration").style.display="flex",document.getElementById("modalDurationValue").textContent=l&&e.duration_es||e.duration):document.getElementById("modalDuration").style.display="none",e.study_hours?(document.getElementById("modalHours").style.display="flex",document.getElementById("modalHoursValue").textContent=l&&e.study_hours_es||e.study_hours):document.getElementById("modalHours").style.display="none";const m=l&&e.content_covered_es||e.content_covered;if(m&&m.length>0){document.getElementById("modalContent").style.display="block";const o=document.getElementById("modalContentList");o.innerHTML="",m.forEach(i=>{const r=document.createElement("li");r.textContent=i,o.appendChild(r)})}else document.getElementById("modalContent").style.display="none";const u=l&&e.learning_outcomes_es||e.learning_outcomes;if(u&&u.length>0){document.getElementById("modalOutcomes").style.display="block";const o=document.getElementById("modalOutcomesList");o.innerHTML="",u.forEach(i=>{const r=document.createElement("li");r.textContent=i,o.appendChild(r)})}else document.getElementById("modalOutcomes").style.display="none";const E=document.getElementById("modalSkills");if(E.innerHTML="",e.skills.forEach(o=>{const i=document.createElement("span");i.className="skill-tag",i.textContent=o,E.appendChild(i)}),e.credential_id)if(document.getElementById("modalCredential").style.display="block",document.getElementById("modalCredentialId").textContent=e.credential_id,e.credential_url){const o=document.getElementById("modalCredentialLink");o.href=e.credential_url,o.style.display="inline-flex"}else document.getElementById("modalCredentialLink").style.display="none";else document.getElementById("modalCredential").style.display="none";e.pdf_url?(document.getElementById("modalPdfLink").href=e.pdf_url,document.getElementById("modalPdfLink").style.display="flex"):document.getElementById("modalPdfLink").style.display="none",e.credential_url?(document.getElementById("modalCredentialLinkFooter").href=e.credential_url,document.getElementById("modalCredentialLinkFooter").style.display="flex"):document.getElementById("modalCredentialLinkFooter").style.display="none",s.style.display="block",setTimeout(()=>{s.classList.add("show")},10),document.body.style.overflow="hidden",s.hasAttribute("data-click-listener")||(s.addEventListener("click",function(o){o.target===s&&y()}),s.setAttribute("data-click-listener","true"))}function y(){const c=document.getElementById("certificateModal");c&&(c.classList.remove("show"),setTimeout(()=>{c.style.display="none"},300),document.body.style.overflow="auto")}window.closeCertificateModal=y;document.addEventListener("DOMContentLoaded",function(){const c=document.getElementById("categoryFilter"),e=document.getElementById("typeFilter"),s=document.getElementById("skillFilter"),p=document.getElementById("clearFilters"),l=document.getElementById("certificatesGrid"),m=document.getElementById("noResults"),u=document.querySelectorAll(".certificate-card");document.querySelectorAll(".close-btn, .close-modal-btn").forEach(n=>{n.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),y()})}),document.addEventListener("keydown",function(n){if(n.key==="Escape"){const t=document.getElementById("certificateModal");t&&t.style.display==="block"&&y()}}),u.forEach(n=>{const t=n.querySelector(".certificate-link");t&&t.addEventListener("click",function(d){d.preventDefault(),d.stopPropagation(),console.log("Button clicked!"),g(n)}),n.addEventListener("click",function(d){(d.target===n||d.target.closest(".certificate-content"))&&(console.log("Card clicked!"),g(n))})});function o(){document.querySelectorAll(".certificate-card").forEach(t=>{const d=t.querySelector(".certificate-link");d&&!d.hasAttribute("data-listener-added")&&(d.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation(),console.log("Button clicked in addEventListenersToCards!"),g(t)}),d.setAttribute("data-listener-added","true")),t.hasAttribute("data-card-listener-added")||(t.addEventListener("click",function(a){(a.target===t||a.target.closest(".certificate-content"))&&(console.log("Card clicked in addEventListenersToCards!"),g(t))}),t.setAttribute("data-card-listener-added","true"))})}function i(){const n=c.value,t=e.value,d=s.value;let a=0;u.forEach(f=>{const k=f.dataset.category,B=f.dataset.type,I=f.dataset.skills,C=!n||k===n,L=!t||B===t,h=!d||I.includes(d);C&&L&&h?(f.style.display="block",a++):f.style.display="none"}),a===0?(m.style.display="block",l.style.display="none"):(m.style.display="none",l.style.display="grid"),o()}function r(){c.value="",e.value="",s.value="",i()}c.addEventListener("change",i),e.addEventListener("change",i),s.addEventListener("change",i),p.addEventListener("click",r),o(),window.addEventListener("click",function(n){const t=document.getElementById("certificateModal");n.target===t&&y()}),document.addEventListener("keydown",function(n){n.key==="Escape"&&y()})});
